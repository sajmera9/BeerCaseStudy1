---
title: "Beer Case Study 1"
output: html_notebook
---


```{r}
library(tidyverse)
beer = read.csv(file.choose(), header = TRUE)
breweries = read.csv(file.choose(), header = TRUE)
beer
```



```{r}
# 1. How many breweries are present in each state?
mpg %>% group_by(class) %>% summarize(meanCTY = mean(cty), count = n())
StateCount = breweries %>% group_by(State) %>% count(State) %>% arrange(desc(n))
StateCount
```






```{r}
#2.   Merge beer data with the breweries data. Print the first 6 observations and the last six observations to check the merged file.  (RMD only, this does not need to be included in the presentation or the deck.)
library(dplyr)

merged_data = merge(beer, breweries, by.x = "Brewery_id", by.y = "Brew_ID")
merged_data

colnames(merged_data)[2] = "Beer_Name"
colnames(merged_data)[8] = "Brewery_Name"
merged_data
```

```{r}
#Address the missing values in each column.
#There are 62 missing values in ABV and 1005 missing values in 1005
library(naniar)
gg_miss_var(merged_data)
sapply(merged_data, function(x) sum(is.na(x)))


```

```{r}
# 4.   Compute the median alcohol content and international bitterness unit for each state. Plot a bar chart to compare.

#Removed the missing values in the ABV and IBU column.
#Then got the median ABV and median IBU.
na_merged_data = merged_data %>% filter(!is.na(ABV) & !is.na(IBU))
median_data = na_merged_data %>% group_by(State) %>% summarize(medianABV = median(ABV), medianIBU = median(IBU))
median_data

#created a bar chart comparing the medianABV per state
median_data %>% ggplot(aes(x = State, y = medianABV, fill = State)) + geom_col()

#created a bar chart comparing the medianIBU per state
median_data %>% ggplot(aes(x = State, y = medianIBU, fill = State)) + geom_col()

median_data %>% arrange(desc(medianABV))
```

```{r}
#5.Which state has the maximum alcoholic (ABV) beer? Which state has the most bitter (IBU) beer?

#Get the Max IBU per state
maxIBU = na_merged_data %>% group_by(State) %>% summarise(MaxIBU.per.State = max(IBU)) %>% arrange(desc(MaxIBU.per.State))

maxIBU

#Get the Max ABV per state
maxABV = na_merged_data %>% group_by(State) %>% summarise(MaxABV.per.State = max(ABV)) %>% arrange(desc(MaxABV.per.State))

maxABV
```

```{r}
#6. Comment on the summary statistics and distribution of the ABV variable.
summary(na_merged_data)

hist(na_merged_data$ABV)
na_merged_data %>% ggplot(aes(x = ABV)) + geom_histogram(fill = "blue", color = "black")
```


```{r}
# 7.   Is there an apparent relationship between the bitterness of the beer and its alcoholic content? Draw a scatter plot.  Make your best judgment of a relationship and EXPLAIN your answer.

na_merged_data %>% ggplot(aes(x = ABV, y = IBU, color = State)) + geom_point()


```



```{r}
# 8.  Budweiser would also like to investigate the difference with respect to IBU and ABV between IPAs (India Pale Ales) and other types of Ale (any beer with “Ale” in its name other than IPA).  You decide to use KNN classification to investigate this relationship.  Provide statistical evidence one way or the other. You can of course assume your audience is comfortable with percentages … KNN is very easy to understand conceptually.
```

